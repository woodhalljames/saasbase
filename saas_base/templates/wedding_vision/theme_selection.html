<!-- templates/wedding_vision/theme_selection.html -->
{% extends "base.html" %}

{% block content %}
<div class="container py-4">
  <div class="row">
    <div class="col-md-8">
      <h1>Select a Theme for {{ venue.title }}</h1>
      
      <div class="venue-preview mb-4">
        <img src="{{ venue.image.url }}" class="img-fluid rounded" alt="{{ venue.title }}">
      </div>
      
      <div class="themes-grid">
        <div class="row">
          {% for theme in themes %}
          <div class="col-md-6 mb-4">
            <div class="card h-100">
              <div class="card-header">
                <h5 class="mb-0">{{ theme.name }}</h5>
              </div>
              {% if theme.example_image %}
              <img src="{{ theme.example_image.url }}" class="card-img-top" alt="{{ theme.name }}">
              {% endif %}
              <div class="card-body">
                <p class="card-text">{{ theme.description }}</p>
                <div class="token-cost mb-3">
                  <span class="badge bg-primary">{{ theme.token_cost }} tokens</span>
                </div>
                
                {% if usage_data.remaining >= theme.token_cost %}
                <a href="{% url 'wedding_vision:generate_image' venue.id theme.id %}" 
                   class="btn btn-success w-100">Select Theme</a>
                {% else %}
                <button class="btn btn-secondary w-100" disabled>
                  Not enough tokens ({{ theme.token_cost }} needed)
                </button>
                {% endif %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      {% include "wedding_vision/includes/token_status.html" %}
      
      {% if usage_data.remaining < 5 %}
      <div class="alert alert-warning">
        <h5>Running low on tokens?</h5>
        <p>Upgrade your subscription to get more tokens and unlock premium features!</p>
        <a href="{% url 'subscriptions:pricing' %}" class="btn btn-primary">View Plans</a>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}